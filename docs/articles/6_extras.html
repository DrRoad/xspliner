<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Extra information about the package • xspliner</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top navbar-mi2" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-mi2logo" href="http://mi2.mini.pw.edu.pl/">
        <img src="https://github.com/mi2-warsaw/MI2template/blob/master/inst/pkgdown/assets/MI2logo.jpg?raw=true" alt="MI2" height="46" title="MI2"></a>
      <a class="navbar-brand navbar-mi2" href="../index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="navbar-mi2 nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1_introduction.html">Basic theory and usage</a>
    </li>
    <li>
      <a href="../articles/2_discrete_response_or_predictor.html">Classification and discrete predictors</a>
    </li>
    <li>
      <a href="../articles/3_graphics.html">Graphics</a>
    </li>
    <li>
      <a href="../articles/4_automation.html">Automate you work</a>
    </li>
    <li>
      <a href="../articles/5_methods.html">Methods and xspliner environment</a>
    </li>
    <li>
      <a href="../articles/6_extras.html">Extra information about the package</a>
    </li>
    <li>
      <a href="../articles/7_use_cases.html">Use cases</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Extra information about the package</h1>
                        <h4 class="author">Krystian Igras</h4>
            
            <h4 class="date">2018-12-07</h4>
      
      
      <div class="hidden name"><code>6_extras.Rmd</code></div>

    </div>

    
    
<p>This sections provides some additional information and features that xspliner provides.</p>
<div id="monotonic-splines-approximation" class="section level1">
<h1 class="hasAnchor">
<a href="#monotonic-splines-approximation" class="anchor"></a>Monotonic splines approximation</h1>
<p><em>For qualitative variables only</em></p>
<p>In some cases you may want to transform variables with monotonic function. xspliner provides option for monotonic spline approximation. You just need to specify <code>monotonic</code> parameter for local, or global <code>xs</code> transition. It actually can have 4 values:</p>
<ul>
<li>“not” the default one. Monotonicity is not required</li>
<li>“up” approximation is increasing function</li>
<li>“down” approximation is decreasing function</li>
<li>“auto” compare increasing and decreasing approximation and chooses better one (basing on <span class="math inline">\(R^2\)</span> statistic)</li>
</ul>
<p>Let’s see below example:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(randomForest)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pdp)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(xspliner)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(boston)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">boston_rf &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/randomForest/topics/randomForest">randomForest</a></span>(cmedv <span class="op">~</span><span class="st"> </span>lstat <span class="op">+</span><span class="st"> </span>ptratio <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> boston)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">model_xs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">  cmedv <span class="op">~</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="st">    </span><span class="kw">xs</span>(lstat, <span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">k =</span> <span class="dv">6</span>), <span class="dt">effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">type =</span> <span class="st">"pdp"</span>, <span class="dt">grid.resolution =</span> <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="st">    </span><span class="kw">xs</span>(ptratio, <span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">k =</span> <span class="dv">5</span>), <span class="dt">effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">type =</span> <span class="st">"pdp"</span>, <span class="dt">grid.resolution =</span> <span class="dv">100</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="st">    </span>age,</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">  <span class="dt">model =</span> boston_rf,</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  <span class="dt">xs_opts =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">monotonic =</span> <span class="st">"auto"</span>))</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb1-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model_xs, <span class="st">"ptratio"</span>, <span class="dt">plot_deriv =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="6_extras_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(model_xs, <span class="st">"lstat"</span>, <span class="dt">plot_deriv =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="6_extras_files/figure-html/unnamed-chunk-1-2.png" width="700"></p>
</div>
<div id="choose-if-approximation-is-better" class="section level1">
<h1 class="hasAnchor">
<a href="#choose-if-approximation-is-better" class="anchor"></a>Choose if approximation is better</h1>
<p><em>For qualitative variables only</em></p>
<p>When the response function has linear form, approximating it with splines may make the result worse. <code>xspline</code> function offers automatical check if spline approximation is better than linear one, and use it in final model.</p>
<p>You may find two parameters responsible for that:</p>
<ul>
<li>
<code>alter</code> - The subparameter of <code>transition</code>. We already know how this parameter works for “always” and “never” values. There is also the third option, “auto”. In this case xspline automatically choose whther variable should be transformed with splines</li>
<li>
<code>compare_stat</code> - function of <code>lm</code> class object. Defines statistic that should be used in decision between spline model and linear one. The function should have attribute <code>higher</code>. When the attribute has <code>"better"</code> value then the model with higher statistic value is chosen.</li>
</ul>
<p>You can see the feature in above example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">boston_rf &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/randomForest/topics/randomForest">randomForest</a></span>(cmedv <span class="op">~</span><span class="st"> </span>lstat <span class="op">+</span><span class="st"> </span>ptratio <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> boston)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">model_pdp_auto &lt;-<span class="st"> </span><span class="kw"><a href="../reference/xspline.html">xspline</a></span>(</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  cmedv <span class="op">~</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="st">    </span><span class="kw">xs</span>(lstat, <span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">k =</span> <span class="dv">6</span>), <span class="dt">effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">type =</span> <span class="st">"pdp"</span>, <span class="dt">grid.resolution =</span> <span class="dv">60</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="st">    </span><span class="kw">xs</span>(ptratio, <span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">k =</span> <span class="dv">4</span>), <span class="dt">effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">type =</span> <span class="st">"pdp"</span>, <span class="dt">grid.resolution =</span> <span class="dv">40</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="st">    </span>age,</a>
<a class="sourceLine" id="cb3-8" data-line-number="8">  <span class="dt">model =</span> boston_rf,</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="dt">xs_opts =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">transition =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="dt">alter =</span> <span class="st">"auto"</span>))</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">)</a>
<a class="sourceLine" id="cb3-11" data-line-number="11"></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co"># aic statistic is used by default</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(model_pdp_auto)</a></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = cmedv ~ xs(lstat) + ptratio + age, family = family, 
##     data = data)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -12.7619   -3.2031   -0.6366    2.8787   26.9953  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  4.638819   2.952287   1.571    0.117    
## xs(lstat)    1.248040   0.048545  25.709  &lt; 2e-16 ***
## ptratio     -0.858557   0.113027  -7.596 1.51e-13 ***
## age          0.054359   0.009827   5.532 5.11e-08 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for gaussian family taken to be 24.87722)
## 
##     Null deviance: 42578  on 505  degrees of freedom
## Residual deviance: 12488  on 502  degrees of freedom
## AIC: 3068.2
## 
## Number of Fisher Scoring iterations: 2</code></pre>
<p>Linear approximation was better for <code>ptratio</code> response function.</p>
<p>(todo below sections)</p>
</div>
<div id="specifying-model-family-and-link" class="section level1">
<h1 class="hasAnchor">
<a href="#specifying-model-family-and-link" class="anchor"></a>Specifying model family and link</h1>
<p>(When type is classification)</p>
</div>
<div id="transformed-response" class="section level1">
<h1 class="hasAnchor">
<a href="#transformed-response" class="anchor"></a>Transformed response</h1>
<p>(log(y) ~ .)</p>
</div>
<div id="multiplicative-form" class="section level1">
<h1 class="hasAnchor">
<a href="#multiplicative-form" class="anchor"></a>Multiplicative form</h1>
<p>(form = “multiplicative”)</p>
</div>
<div id="subset-formula" class="section level1">
<h1 class="hasAnchor">
<a href="#subset-formula" class="anchor"></a>Subset formula</h1>
<p>(y ~ x1 + x2 and model uses x3 as well)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#monotonic-splines-approximation">Monotonic splines approximation</a></li>
      <li><a href="#choose-if-approximation-is-better">Choose if approximation is better</a></li>
      <li><a href="#specifying-model-family-and-link">Specifying model family and link</a></li>
      <li><a href="#transformed-response">Transformed response</a></li>
      <li><a href="#multiplicative-form">Multiplicative form</a></li>
      <li><a href="#subset-formula">Subset formula</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Krystian Igras, Przemyslaw Biecek.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
